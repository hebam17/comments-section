{"ast":null,"code":"import _asyncToGenerator from\"E:/courses/my_personal_file/challenges/comments-section/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"E:/courses/my_personal_file/challenges/comments-section/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"E:\\\\courses\\\\my_personal_file\\\\challenges\\\\comments-section\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useState,useEffect}from\"react\";import{useParams,useLocation}from\"react-router-dom\";import Comment from\"./Comment\";import flashData from\"../data.json\";import NewComment from\"./NewComment\";import axios from\"axios\";import{handleComment}from\"../utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Comments(_ref){var username=_ref.username;var params=useParams();var location=useLocation();var _useState=useState(flashData.comments),_useState2=_slicedToArray(_useState,2),comments=_useState2[0],setComments=_useState2[1];var _useState3=useState(flashData.currentUser),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];// const Username = username || params.username;\nuseEffect(function(){var getComments=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(location.pathname!==\"/\")){_context.next=14;break;}_context.prev=1;_context.next=4;return axios.get(\"/comments/all\");case 4:res=_context.sent;console.log(res.data);res.data.sort(function(a,b){return b.score-a.score;});console.log(res.data);setComments(res.data);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.log(_context.t0.message);case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function getComments(){return _ref2.apply(this,arguments);};}();getComments();},[location.pathname]);useEffect(function(){var getUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(location.pathname!==\"/\")){_context2.next=11;break;}_context2.prev=1;_context2.next=4;return axios.get(\"/users/\".concat(params.username));case 4:res=_context2.sent;// console.log(\"user:\", res.data);\nsetUser(res.data);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0.message);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function getUser(){return _ref3.apply(this,arguments);};}();getUser();},[location.pathname,params.username]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"comments\",children:[comments.map(function(comment){return/*#__PURE__*/_jsx(Comment,{currentUser:user,comment:comment},comment.id||comment._id);}),/*#__PURE__*/_jsx(NewComment,{currentUser:user,reply:false,handleComment:handleComment})]})});}","map":{"version":3,"sources":["E:/courses/my_personal_file/challenges/comments-section/client/src/components/Comments.js"],"names":["useState","useEffect","useParams","useLocation","Comment","flashData","NewComment","axios","handleComment","Comments","username","params","location","comments","setComments","currentUser","user","setUser","getComments","pathname","get","res","console","log","data","sort","a","b","score","message","getUser","map","comment","id","_id"],"mappings":"ycAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,OAASC,SAAT,CAAoBC,WAApB,KAAuC,kBAAvC,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,SAAP,KAAsB,cAAtB,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,aAAT,KAA8B,UAA9B,C,6IAEA,cAAe,SAASC,CAAAA,QAAT,MAAgC,IAAZC,CAAAA,QAAY,MAAZA,QAAY,CAC7C,GAAMC,CAAAA,MAAM,CAAGT,SAAS,EAAxB,CACA,GAAMU,CAAAA,QAAQ,CAAGT,WAAW,EAA5B,CACA,cAAgCH,QAAQ,CAACK,SAAS,CAACQ,QAAX,CAAxC,wCAAOA,QAAP,eAAiBC,WAAjB,eACA,eAAwBd,QAAQ,CAACK,SAAS,CAACU,WAAX,CAAhC,yCAAOC,IAAP,eAAaC,OAAb,eAEA;AACAhB,SAAS,CAAC,UAAM,CACd,GAAMiB,CAAAA,WAAW,2FAAG,gJACdN,QAAQ,CAACO,QAAT,GAAsB,GADR,iEAGIZ,CAAAA,KAAK,CAACa,GAAN,iBAHJ,QAGRC,GAHQ,eAIdC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,EACAH,GAAG,CAACG,IAAJ,CAASC,IAAT,CAAc,SAACC,CAAD,CAAIC,CAAJ,QAAUA,CAAAA,CAAC,CAACC,KAAF,CAAUF,CAAC,CAACE,KAAtB,EAAd,EACAN,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,EACAV,WAAW,CAACO,GAAG,CAACG,IAAL,CAAX,CAPc,iFASdF,OAAO,CAACC,GAAR,CAAY,YAAIM,OAAhB,EATc,qEAAH,kBAAXX,CAAAA,WAAW,2CAAjB,CAaAA,WAAW,GACZ,CAfQ,CAeN,CAACN,QAAQ,CAACO,QAAV,CAfM,CAAT,CAiBAlB,SAAS,CAAC,UAAM,CACd,GAAM6B,CAAAA,OAAO,2FAAG,qJACVlB,QAAQ,CAACO,QAAT,GAAsB,GADZ,oEAGQZ,CAAAA,KAAK,CAACa,GAAN,kBAAoBT,MAAM,CAACD,QAA3B,EAHR,QAGJW,GAHI,gBAIV;AACAJ,OAAO,CAACI,GAAG,CAACG,IAAL,CAAP,CALU,mFAOVF,OAAO,CAACC,GAAR,CAAY,aAAIM,OAAhB,EAPU,sEAAH,kBAAPC,CAAAA,OAAO,2CAAb,CAWAA,OAAO,GACR,CAbQ,CAaN,CAAClB,QAAQ,CAACO,QAAV,CAAoBR,MAAM,CAACD,QAA3B,CAbM,CAAT,CAeA,mBACE,sCACE,aAAK,SAAS,CAAC,UAAf,WACGG,QAAQ,CAACkB,GAAT,CAAa,SAACC,OAAD,qBACZ,KAAC,OAAD,EACE,WAAW,CAAEhB,IADf,CAEE,OAAO,CAAEgB,OAFX,EAGOA,OAAO,CAACC,EAAR,EAAcD,OAAO,CAACE,GAH7B,CADY,EAAb,CADH,cAQE,KAAC,UAAD,EACE,WAAW,CAAElB,IADf,CAEE,KAAK,CAAE,KAFT,CAGE,aAAa,CAAER,aAHjB,EARF,GADF,EADF,CAkBD","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { useParams, useLocation } from \"react-router-dom\";\r\nimport Comment from \"./Comment\";\r\nimport flashData from \"../data.json\";\r\nimport NewComment from \"./NewComment\";\r\nimport axios from \"axios\";\r\nimport { handleComment } from \"../utils\";\r\n\r\nexport default function Comments({ username }) {\r\n  const params = useParams();\r\n  const location = useLocation();\r\n  const [comments, setComments] = useState(flashData.comments);\r\n  const [user, setUser] = useState(flashData.currentUser);\r\n\r\n  // const Username = username || params.username;\r\n  useEffect(() => {\r\n    const getComments = async () => {\r\n      if (location.pathname !== \"/\") {\r\n        try {\r\n          const res = await axios.get(`/comments/all`);\r\n          console.log(res.data);\r\n          res.data.sort((a, b) => b.score - a.score);\r\n          console.log(res.data);\r\n          setComments(res.data);\r\n        } catch (err) {\r\n          console.log(err.message);\r\n        }\r\n      }\r\n    };\r\n    getComments();\r\n  }, [location.pathname]);\r\n\r\n  useEffect(() => {\r\n    const getUser = async () => {\r\n      if (location.pathname !== \"/\") {\r\n        try {\r\n          const res = await axios.get(`/users/${params.username}`);\r\n          // console.log(\"user:\", res.data);\r\n          setUser(res.data);\r\n        } catch (err) {\r\n          console.log(err.message);\r\n        }\r\n      }\r\n    };\r\n    getUser();\r\n  }, [location.pathname, params.username]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"comments\">\r\n        {comments.map((comment) => (\r\n          <Comment\r\n            currentUser={user}\r\n            comment={comment}\r\n            key={comment.id || comment._id}\r\n          />\r\n        ))}\r\n        <NewComment\r\n          currentUser={user}\r\n          reply={false}\r\n          handleComment={handleComment}\r\n        />\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}