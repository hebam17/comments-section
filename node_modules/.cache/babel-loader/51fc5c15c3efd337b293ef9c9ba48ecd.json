{"ast":null,"code":"import _slicedToArray from\"E:/courses/my_personal_file/challenges/comments-section/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useRef}from\"react\";import Delete from\"./Delete\";import Edit from\"./Edit\";import Info from\"./Info\";import Replies from\"./Replies\";import Reply from\"./Reply\";import Scores from\"./Scores\";import NewComment from\"./NewComment\";import Update from\"./Update\";import{handleReply as _handleReply,handleReplyActive as _handleReplyActive,handleEditComment as _handleEditComment,handleUpdateComment as _handleUpdateComment,handleDeleteModal as _handleDeleteModal,_handleCancelDelete,handleConfirmDeleteComment as _handleConfirmDeleteComment}from\"../utils\";import{DeleteModal}from\"./DeleteModal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Comment(_ref){var comment=_ref.comment,currentUser=_ref.currentUser;var _useState=useState(comment.content),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),replyComment=_useState4[0],setReplyComment=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),update=_useState6[0],setUpdate=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),displayModal=_useState8[0],setDisplayModal=_useState8[1];var textRef=useRef();var deleteRef=useRef();useEffect(function(){if(deleteRef){try{window.onclick=function(e){if(e.target.isEqualNode(deleteRef.current.firstElementChild)){setDisplayModal(\"none\");deleteRef.current.style.display=\"none\";}};}catch(err){console.log(err.message);}}},[deleteRef,displayModal]);var handleText=function handleText(e){setText(e.target.value);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(DeleteModal,{ref:deleteRef,handleCancelDelete:function handleCancelDelete(){return _handleCancelDelete(setDisplayModal,deleteRef);},handleConfirmDeleteComment:function handleConfirmDeleteComment(){return _handleConfirmDeleteComment(currentUser,comment,setDisplayModal,deleteRef);}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"comment-scores\",children:/*#__PURE__*/_jsx(Scores,{score:comment.score,currentUser:currentUser,commentId:comment._id})}),/*#__PURE__*/_jsxs(\"div\",{className:\"comment-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-controllers\",children:[currentUser.username===comment.user.username?/*#__PURE__*/_jsx(\"div\",{className:\"info-co\",children:/*#__PURE__*/_jsx(Info,{profileUser:\"you\",user:comment.user,createdAt:comment.createdAt})}):/*#__PURE__*/_jsx(\"div\",{className:\"info-co\",children:/*#__PURE__*/_jsx(Info,{profileUser:\"user\",user:comment.user,createdAt:comment.createdAt})}),/*#__PURE__*/_jsx(\"div\",{className:\"tools\",children:currentUser.username===comment.user.username?/*#__PURE__*/_jsxs(\"div\",{className:\"comment-delete\",children:[/*#__PURE__*/_jsx(Delete,{handleDeleteModal:function handleDeleteModal(){return _handleDeleteModal(setDisplayModal,deleteRef);}}),/*#__PURE__*/_jsx(Edit,{handleEditComment:function handleEditComment(){_handleEditComment(textRef,setUpdate);}})]}):/*#__PURE__*/_jsx(\"div\",{className:\"comment-reply\",children:/*#__PURE__*/_jsx(Reply,{handleReply:function handleReply(){return _handleReply(setReplyComment);}})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text\",children:[/*#__PURE__*/_jsx(\"textarea\",{name:\"comment\",value:text,readOnly:true,onChange:handleText,ref:textRef}),/*#__PURE__*/_jsx(\"div\",{className:\"invisible\",children:text})]}),update&&/*#__PURE__*/_jsx(\"div\",{className:\"comment-update\",children:/*#__PURE__*/_jsx(Update,{handleUpdateComment:function handleUpdateComment(){return _handleUpdateComment(comment,currentUser,text);}})})]})]}),replyComment&&/*#__PURE__*/_jsx(NewComment,{currentUser:currentUser,handleReplyActive:function handleReplyActive(txt){_handleReplyActive(setReplyComment,txt,comment,currentUser);},reply:true}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-replies\",children:comment.replies.map(function(reply){return/*#__PURE__*/_jsx(Replies,{currentUser:currentUser,commentUser:comment.user.username,reply:reply,comment:comment,handleReplyActive:function handleReplyActive(txt){_handleReplyActive(setReplyComment,txt);}},reply.id||reply._id);})})]})]});}","map":{"version":3,"sources":["E:/courses/my_personal_file/challenges/comments-section/client/src/components/Comment.js"],"names":["useState","useEffect","useRef","Delete","Edit","Info","Replies","Reply","Scores","NewComment","Update","handleReply","handleReplyActive","handleEditComment","handleUpdateComment","handleDeleteModal","_handleCancelDelete","handleConfirmDeleteComment","DeleteModal","Comment","comment","currentUser","content","text","setText","replyComment","setReplyComment","update","setUpdate","displayModal","setDisplayModal","textRef","deleteRef","window","onclick","e","target","isEqualNode","current","firstElementChild","style","display","err","console","log","message","handleText","value","score","_id","username","user","createdAt","txt","replies","map","reply","id"],"mappings":"oJAAA,OAASA,QAAT,CAAmBC,SAAnB,CAA8BC,MAA9B,KAA4C,OAA5C,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CACA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,OACEC,WAAW,GAAXA,CAAAA,YADF,CAEEC,iBAAiB,GAAjBA,CAAAA,kBAFF,CAGEC,iBAAiB,GAAjBA,CAAAA,kBAHF,CAIEC,mBAAmB,GAAnBA,CAAAA,oBAJF,CAKEC,iBAAiB,GAAjBA,CAAAA,kBALF,CAMEC,mBANF,CAOEC,0BAA0B,GAA1BA,CAAAA,2BAPF,KAQO,UARP,CASA,OAASC,WAAT,KAA4B,eAA5B,C,6IAEA,cAAe,SAASC,CAAAA,OAAT,MAA2C,IAAxBC,CAAAA,OAAwB,MAAxBA,OAAwB,CAAfC,WAAe,MAAfA,WAAe,CACxD,cAAwBrB,QAAQ,CAACoB,OAAO,CAACE,OAAT,CAAhC,wCAAOC,IAAP,eAAaC,OAAb,eACA,eAAwCxB,QAAQ,CAAC,KAAD,CAAhD,yCAAOyB,YAAP,eAAqBC,eAArB,eACA,eAA4B1B,QAAQ,CAAC,KAAD,CAApC,yCAAO2B,MAAP,eAAeC,SAAf,eACA,eAAwC5B,QAAQ,CAAC,EAAD,CAAhD,yCAAO6B,YAAP,eAAqBC,eAArB,eACA,GAAMC,CAAAA,OAAO,CAAG7B,MAAM,EAAtB,CACA,GAAM8B,CAAAA,SAAS,CAAG9B,MAAM,EAAxB,CACAD,SAAS,CAAC,UAAM,CACd,GAAI+B,SAAJ,CAAe,CACb,GAAI,CACFC,MAAM,CAACC,OAAP,CAAiB,SAACC,CAAD,CAAO,CACtB,GAAIA,CAAC,CAACC,MAAF,CAASC,WAAT,CAAqBL,SAAS,CAACM,OAAV,CAAkBC,iBAAvC,CAAJ,CAA+D,CAC7DT,eAAe,CAAC,MAAD,CAAf,CACAE,SAAS,CAACM,OAAV,CAAkBE,KAAlB,CAAwBC,OAAxB,CAAkC,MAAlC,CACD,CACF,CALD,CAMD,CAAC,MAAOC,GAAP,CAAY,CACZC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB,EACD,CACF,CACF,CAbQ,CAaN,CAACb,SAAD,CAAYH,YAAZ,CAbM,CAAT,CAeA,GAAMiB,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACX,CAAD,CAAO,CACxBX,OAAO,CAACW,CAAC,CAACC,MAAF,CAASW,KAAV,CAAP,CACD,CAFD,CAIA,mBACE,wCACE,KAAC,WAAD,EACE,GAAG,CAAEf,SADP,CAEE,kBAAkB,CAAE,oCAClBhB,CAAAA,mBAAmB,CAACc,eAAD,CAAkBE,SAAlB,CADD,EAFtB,CAKE,0BAA0B,CAAE,4CAC1Bf,CAAAA,2BAA0B,CACxBI,WADwB,CAExBD,OAFwB,CAGxBU,eAHwB,CAIxBE,SAJwB,CADA,EAL9B,EADF,cAeE,oCACE,aAAK,SAAS,CAAC,SAAf,wBACE,YAAK,SAAS,CAAC,gBAAf,uBACE,KAAC,MAAD,EACE,KAAK,CAAEZ,OAAO,CAAC4B,KADjB,CAEE,WAAW,CAAE3B,WAFf,CAGE,SAAS,CAAED,OAAO,CAAC6B,GAHrB,EADF,EADF,cAQE,aAAK,SAAS,CAAC,cAAf,wBACE,aAAK,SAAS,CAAC,qBAAf,WACG5B,WAAW,CAAC6B,QAAZ,GAAyB9B,OAAO,CAAC+B,IAAR,CAAaD,QAAtC,cACC,YAAK,SAAS,CAAC,SAAf,uBACE,KAAC,IAAD,EACE,WAAW,CAAC,KADd,CAEE,IAAI,CAAE9B,OAAO,CAAC+B,IAFhB,CAGE,SAAS,CAAE/B,OAAO,CAACgC,SAHrB,EADF,EADD,cASC,YAAK,SAAS,CAAC,SAAf,uBACE,KAAC,IAAD,EACE,WAAW,CAAC,MADd,CAEE,IAAI,CAAEhC,OAAO,CAAC+B,IAFhB,CAGE,SAAS,CAAE/B,OAAO,CAACgC,SAHrB,EADF,EAVJ,cAmBE,YAAK,SAAS,CAAC,OAAf,UACG/B,WAAW,CAAC6B,QAAZ,GAAyB9B,OAAO,CAAC+B,IAAR,CAAaD,QAAtC,cACC,aAAK,SAAS,CAAC,gBAAf,wBACE,KAAC,MAAD,EACE,iBAAiB,CAAE,mCACjBnC,CAAAA,kBAAiB,CAACe,eAAD,CAAkBE,SAAlB,CADA,EADrB,EADF,cAME,KAAC,IAAD,EACE,iBAAiB,CAAE,4BAAM,CACvBnB,kBAAiB,CAACkB,OAAD,CAAUH,SAAV,CAAjB,CACD,CAHH,EANF,GADD,cAcC,YAAK,SAAS,CAAC,eAAf,uBACE,KAAC,KAAD,EAAO,WAAW,CAAE,6BAAMjB,CAAAA,YAAW,CAACe,eAAD,CAAjB,EAApB,EADF,EAfJ,EAnBF,GADF,cAyCE,aAAK,SAAS,CAAC,MAAf,wBACE,iBACE,IAAI,CAAC,SADP,CAEE,KAAK,CAAEH,IAFT,CAGE,QAAQ,CAAE,IAHZ,CAIE,QAAQ,CAAEuB,UAJZ,CAKE,GAAG,CAAEf,OALP,EADF,cAQE,YAAK,SAAS,CAAC,WAAf,UAA4BR,IAA5B,EARF,GAzCF,CAmDGI,MAAM,eACL,YAAK,SAAS,CAAC,gBAAf,uBACE,KAAC,MAAD,EACE,mBAAmB,CAAE,qCACnBb,CAAAA,oBAAmB,CAACM,OAAD,CAAUC,WAAV,CAAuBE,IAAvB,CADA,EADvB,EADF,EApDJ,GARF,GADF,CAuEGE,YAAY,eACX,KAAC,UAAD,EACE,WAAW,CAAEJ,WADf,CAEE,iBAAiB,CAAE,2BAACgC,GAAD,CAAS,CAC1BzC,kBAAiB,CAACc,eAAD,CAAkB2B,GAAlB,CAAuBjC,OAAvB,CAAgCC,WAAhC,CAAjB,CACD,CAJH,CAKE,KAAK,KALP,EAxEJ,cAgFE,YAAK,SAAS,CAAC,iBAAf,UACGD,OAAO,CAACkC,OAAR,CAAgBC,GAAhB,CAAoB,SAACC,KAAD,qBACnB,KAAC,OAAD,EACE,WAAW,CAAEnC,WADf,CAEE,WAAW,CAAED,OAAO,CAAC+B,IAAR,CAAaD,QAF5B,CAGE,KAAK,CAAEM,KAHT,CAKE,OAAO,CAAEpC,OALX,CAME,iBAAiB,CAAE,2BAACiC,GAAD,CAAS,CAC1BzC,kBAAiB,CAACc,eAAD,CAAkB2B,GAAlB,CAAjB,CACD,CARH,EAIOG,KAAK,CAACC,EAAN,EAAYD,KAAK,CAACP,GAJzB,CADmB,EAApB,CADH,EAhFF,GAfF,GADF,CAiHD","sourcesContent":["import { useState, useEffect, useRef } from \"react\";\r\nimport Delete from \"./Delete\";\r\nimport Edit from \"./Edit\";\r\nimport Info from \"./Info\";\r\nimport Replies from \"./Replies\";\r\nimport Reply from \"./Reply\";\r\nimport Scores from \"./Scores\";\r\nimport NewComment from \"./NewComment\";\r\nimport Update from \"./Update\";\r\nimport {\r\n  handleReply,\r\n  handleReplyActive,\r\n  handleEditComment,\r\n  handleUpdateComment,\r\n  handleDeleteModal,\r\n  _handleCancelDelete,\r\n  handleConfirmDeleteComment,\r\n} from \"../utils\";\r\nimport { DeleteModal } from \"./DeleteModal\";\r\n\r\nexport default function Comment({ comment, currentUser }) {\r\n  const [text, setText] = useState(comment.content);\r\n  const [replyComment, setReplyComment] = useState(false);\r\n  const [update, setUpdate] = useState(false);\r\n  const [displayModal, setDisplayModal] = useState(\"\");\r\n  const textRef = useRef();\r\n  const deleteRef = useRef();\r\n  useEffect(() => {\r\n    if (deleteRef) {\r\n      try {\r\n        window.onclick = (e) => {\r\n          if (e.target.isEqualNode(deleteRef.current.firstElementChild)) {\r\n            setDisplayModal(\"none\");\r\n            deleteRef.current.style.display = \"none\";\r\n          }\r\n        };\r\n      } catch (err) {\r\n        console.log(err.message);\r\n      }\r\n    }\r\n  }, [deleteRef, displayModal]);\r\n\r\n  const handleText = (e) => {\r\n    setText(e.target.value);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <DeleteModal\r\n        ref={deleteRef}\r\n        handleCancelDelete={() =>\r\n          _handleCancelDelete(setDisplayModal, deleteRef)\r\n        }\r\n        handleConfirmDeleteComment={() =>\r\n          handleConfirmDeleteComment(\r\n            currentUser,\r\n            comment,\r\n            setDisplayModal,\r\n            deleteRef\r\n          )\r\n        }\r\n      />\r\n      <div>\r\n        <div className=\"comment\">\r\n          <div className=\"comment-scores\">\r\n            <Scores\r\n              score={comment.score}\r\n              currentUser={currentUser}\r\n              commentId={comment._id}\r\n            />\r\n          </div>\r\n          <div className=\"comment-info\">\r\n            <div className=\"comment-controllers\">\r\n              {currentUser.username === comment.user.username ? (\r\n                <div className=\"info-co\">\r\n                  <Info\r\n                    profileUser=\"you\"\r\n                    user={comment.user}\r\n                    createdAt={comment.createdAt}\r\n                  />\r\n                </div>\r\n              ) : (\r\n                <div className=\"info-co\">\r\n                  <Info\r\n                    profileUser=\"user\"\r\n                    user={comment.user}\r\n                    createdAt={comment.createdAt}\r\n                  />\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"tools\">\r\n                {currentUser.username === comment.user.username ? (\r\n                  <div className=\"comment-delete\">\r\n                    <Delete\r\n                      handleDeleteModal={() =>\r\n                        handleDeleteModal(setDisplayModal, deleteRef)\r\n                      }\r\n                    />\r\n                    <Edit\r\n                      handleEditComment={() => {\r\n                        handleEditComment(textRef, setUpdate);\r\n                      }}\r\n                    />\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"comment-reply\">\r\n                    <Reply handleReply={() => handleReply(setReplyComment)} />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"text\">\r\n              <textarea\r\n                name=\"comment\"\r\n                value={text}\r\n                readOnly={true}\r\n                onChange={handleText}\r\n                ref={textRef}\r\n              />\r\n              <div className=\"invisible\">{text}</div>\r\n            </div>\r\n            {update && (\r\n              <div className=\"comment-update\">\r\n                <Update\r\n                  handleUpdateComment={() =>\r\n                    handleUpdateComment(comment, currentUser, text)\r\n                  }\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n        {replyComment && (\r\n          <NewComment\r\n            currentUser={currentUser}\r\n            handleReplyActive={(txt) => {\r\n              handleReplyActive(setReplyComment, txt, comment, currentUser);\r\n            }}\r\n            reply\r\n          />\r\n        )}\r\n        <div className=\"comment-replies\">\r\n          {comment.replies.map((reply) => (\r\n            <Replies\r\n              currentUser={currentUser}\r\n              commentUser={comment.user.username}\r\n              reply={reply}\r\n              key={reply.id || reply._id}\r\n              comment={comment}\r\n              handleReplyActive={(txt) => {\r\n                handleReplyActive(setReplyComment, txt);\r\n              }}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}